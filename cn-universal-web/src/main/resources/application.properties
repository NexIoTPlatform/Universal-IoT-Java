# ================================
# Spring Boot 基础配置
# ================================
spring.profiles.active=@profileActive@
# ================================
# 任务执行器配置
# ================================
spring.task.execution.threadNamePrefix=univ-excute-
spring.task.execution.pool.core-size=2
spring.task.execution.pool.max-size=10
spring.task.execution.pool.queue-capacity=10
spring.task.execution.pool.keep-alive=10s
# ================================
# MyBatis 配置
# ================================
mybatis.configuration.map-underscore-to-camel-case=true
# ================================
# 数据库连接池配置
# ================================
druid.mysql.usePingMethod=false
# ================================
# Spring MVC 配置
# ================================
# 启用隐藏方法过滤器（解决上传图片失败问题）
spring.mvc.hiddenmethod.filter.enabled=true
# 文件上传大小限制
spring.servlet.multipart.max-file-size=10MB
# ================================
# Quartz 调度器配置
# ================================
spring.quartz.scheduler-name=UnivScheduler
spring.quartz.startup-delay=1s
spring.quartz.overwrite-existing-jobs=true
spring.quartz.auto-startup=true
spring.quartz.job-store-type=JDBC
# Quartz 属性配置
spring.quartz.properties.org.quartz.scheduler.instanceName=UnivScheduler
spring.quartz.properties.org.quartz.scheduler.instanceId=AUTO
spring.quartz.properties.org.quartz.scheduler.batchTriggerAcquisitionMaxCount=5
# 线程池配置
spring.quartz.properties.org.quartz.threadPool.class=org.quartz.simpl.SimpleThreadPool
spring.quartz.properties.org.quartz.threadPool.threadCount=20
spring.quartz.properties.org.quartz.threadPool.threadPriority=5
# JobStore 配置
spring.quartz.properties.org.quartz.jobStore.class=org.springframework.scheduling.quartz.LocalDataSourceJobStore
spring.quartz.properties.org.quartz.jobStore.isClustered=true
spring.quartz.properties.org.quartz.jobStore.clusterCheckinInterval=150000
spring.quartz.properties.org.quartz.jobStore.txIsolationLevelSerializable=false
spring.quartz.properties.org.quartz.jobStore.misfireThreshold=600000
spring.quartz.properties.org.quartz.jobStore.tablePrefix=qrtz_
spring.quartz.properties.org.quartz.jobStore.acquireTriggersWithinLock=true
spring.quartz.properties.org.quartz.jobStore.dataSource=quartzDs
# ================================
# XSS 防护配置
# ================================
# 新版本 XSS 配置
cn.universal.xss.skipUrl[0]=/iot/weixin/**
cn.universal.xss.skipUrl[1]=/admin/v1/protocol/**
cn.universal.xss.skipUrl[2]=/admin/v1/product/**
cn.universal.xss.skipUrl[3]=/magic/**
# ================================
# Spring 配置
# ================================
spring.main.allow-circular-references=true
# ================================
# 安全配置
# ================================
spring.security.oauth2.resourceserver.jwt.issuer-uri=http://localhost:9091
# ================================
# 监控配置
# ================================
# 启用虚拟线程监控
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.metrics.tags.application=cn-universal
management.prometheus.metrics.export.enabled=true
# ================================
# Lombok 配置
# ================================
lombok.experimental.superBuilder=true
# ================================
# 日志配置
# ================================
# 抑制 commons-logging 警告
logging.level.org.springframework.jcl=OFF
logging.level.org.apache.commons.logging=OFF
logging.level.org.apache.commons.logging.impl=OFF
# ================================
# Magic API 插件配置
# ================================
# 启用 Magic API
magic-api.enabled=true
# Web 编辑器配置
magic-api.web=/magic/debug
magic-api.prefix=/magic
# 编辑器配置文件存储位置（classpath 开头时为只读模式）
magic-api.editor-config=classpath:./magic-editor-config.js
# 资源文件存储配置
magic-api.resource.type=database
magic-api.resource.datasource=
magic-api.resource.prefix=universal
magic-api.resource.tableName=protocol_file
# 备份配置
magic-api.backup.enable=true
magic-api.backup.datasource=
magic-api.backup.max-history=30
magic-api.backup.table-name=protocol_file_backup
# ================================
# RuleGo 规则引擎配置
# ================================
# RuleGo API配置
rulego.web.base-url=http://rule.192886.xyz:81/#
rulego.api.base-url=http://192.168.31.194:9090
rulego.api.token=${RULEGO_API_TOKEN:2af255ea5618467d914c67a8beeca31d}
# RuleGo同步配置
rulego.sync.enabled=false
rulego.sync.interval=300000
rulego.sync.log-cleanup-enabled=true
rulego.sync.log-retention-days=30
